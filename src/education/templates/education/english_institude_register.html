{% extends '_layout.html' %}
{% load static %}
{% block jsBlock %}
<script src="{% static 'assets/vendors/select2/dist/js/select2.min.js' %}"></script>

<script>
    </script>
     <script>
        $('input[type=file]').addClass('form-control');
        $('input[type=number]').addClass('form-control');
        $('input[type=text]').addClass('form-control');
        $('input[type=email]').addClass('form-control');
        $('select').addClass('form-control');
        $(document).ready(function () { $('select').select2();});
        $("#id_name_founder").attr("placeholder", "نام و نام خانوادگی موسس");
        $("#id_name_manager").attr("placeholder", "نام و نام خانوادگی مدیر");
        $("#id_score").attr("placeholder", "امتیاز کیفیت بخشی");
        $("#id_bin_number").attr("placeholder", "شماره حساب مرکز");
        $("#id_bank").attr("placeholder", "نزد بانک");
        $("#id_branch").attr("placeholder", "شعبه");
        $("#id_english_institute").attr("placeholder", "آموزشگاه");


    </script>



    {% endblock %}

    {% block cssBlock %}
    <link href="{% static 'assets/vendors/select2/dist/css/select2.min.css' %}" rel="stylesheet" />
    <link href="{% static 'custom.css' %}" rel="stylesheet"/>
    <style>
        span.select2.select2-container.select2-container--default {
            width: 100% !important;
        }
        p{
            font-weight: bold;
        }
    </style>

    {% endblock %}

    {% block pageContent %}
    <div class="">
        <div class="tab-pane" role="tabpanel" id="complete">
            <div class="x_panel">
                <div class="x_title bg-primary">
                    <ul class="nav navbar-left panel_toolbox">
                        <li>
                            <a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                        <li>
                            <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>

                <form action="" method="post" role="form" enctype="multipart/form-data" style="margin-top: -11px;">
                    {% csrf_token %}
                    <br>

                <div class="clearfix"></div>
                
                <input class="hidden" name="user" value="{{ request.user.id }}" type="number">

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.name_founder }}
                </div>
                
                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.name_manager }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.score }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.bin_number }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.bank }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    {{ form.branch }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> آموزشگاه :</p>
                    {{ form.english_institute }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> شهرستان :</p>
                    {{ form.city }}
                </div>
          

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> منطقه :</p>
                    {{ form.district }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> ناحیه :</p>
                    {{ form.area }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> نوع مجوز :</p>
                    {{ form.permission_type }}
                </div>

                <div class="col-md-4 col-sm-12 col-xs-12 form-group pull-right">
                    <p class="control-label col-md-4 col-sm-12 col-xs-12 pull-right"> جنسیت  :</p>
                    {{ form.sex }}
                </div>

                <div class="col-md-12 col-sm-12 col-xs-12 form-group pull-right">

                    <div class="col-md-12 col-sm-12 col-xs-12 form-group pull-right">
                        <label class="control-label col-md-12 col-sm-12 col-xs-12 pull-right">
                            افزودن دوره  </label>

                    <div class="input-group" id="whoGroup" data-toggle="tooltip">

                        <select class="form-control" name ="english_term" id="english_term">
                            {% for term in terms %}
                            <option value="{{term.id}}"> {{term.name}}</option>
                        {% endfor %}
                        </select>     

                        <span class="input-group-btn">
                            <button type="button" onclick="AddInstitute()" class="btn btn-primary"><i
                                    class="fa fa-plus"></i></button>
                        </span>
                    </div>

                    <div class="col-md-12 col-sm-12 col-xs-12 form-group pull-right table-responsive">
                        <table  class="table table-striped table-bordered dt-responsive nowrap"
                            cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                    <th>سطح دوره</th>
                                    <th>محتوای اموزشی</th>
                                    <th>تعداد جلسات</th>
                                    <th> حداکثر تعداد دانش آموز در کلاس </th>
                                    <th>نرخ یک جلسه آموزشی 90 دقیقه</th>
                                    <th>نرخ یک دوره آموزشی بر اساس N جلسه</th>
                                    <th>حذف</th>
                                </tr>
                            </thead>
                            <tbody id="TblTerm">

                                {% for table_term in table_terms %}
                                <tr id="{{item.TeamMember.member}}">
                                    <td>
                                        {{ table_term.english_institute_define_term.name }}
                                        <input name='TermId' value='{{ table_term.english_institute_define_term.id }}' class='hidden'>
                                    </td>
                                    <td>
                                        <input name='education_content' required value="{{ table_term.education_content }}"   type='text'>
                                    </td>
                                    <td>
                                        <input name='session_number' required value="{{ table_term.session_number }}"   type='number'>
                                    </td>
                                    <td>
                                        <input name='max_student' required value="{{ table_term.max_student }}"   type='number'>
                                    </td>
                                    <td>
                                        <input name='session_price' required value="{{ table_term.session_price }}"   type='number'>
                                    </td>
                                    <td>
                                        <input name='nsession_price' required value="{{ table_term.nsession_price }}"   type='number'>
                                    </td>
                                    <td>
                                        <span class='glyphicon glyphicon-trash row-remover btn btn-danger '></span>
                                    </td>
                                </tr>
                                {% endfor %}

                            </tbody>
                        </table>
                    </div>

                    <script>
                        let tableIndex = 0;
                        function AddInstitute() {

                            let val = $('#english_term').val();
                            let text = $("#english_term option:selected").text();
                            var x = document.getElementById("TblTerm").rows.namedItem(val);
                            console.log(x);
                            if (x == null) {
                                var table = document.getElementById("TblTerm");
                                var row = table.insertRow(tableIndex);
                                row.id = val;
                                var cell1 = row.insertCell(0);
                                var cell2 = row.insertCell(1);
                                var cell3 = row.insertCell(2);
                                var cell4 = row.insertCell(3);
                                var cell5 = row.insertCell(4);
                                var cell6 = row.insertCell(5);
                                var cell7 = row.insertCell(6);


                                cell1.innerHTML = text + "<input name='TermId' value='" + val + "' class='hidden'>";
                                cell2.innerHTML = "<input name='education_content' required   type='text'>"
                                cell3.innerHTML = "<input name='session_number' required min='1'  type='number'>"
                                cell4.innerHTML = "<input name='max_student' required min='1'  type='number'>"
                                cell5.innerHTML = "<input name='session_price' required min='1'  type='number'>"
                                cell6.innerHTML = "<input name='nsession_price' required min='1'  type='number'>"
                                cell7.innerHTML = "<span class='glyphicon glyphicon-trash row-remover btn btn-danger '></span>";
                                tableIndex++;
                            }
                        }
                        $("body").on('click', '.row-remover', function() {
                            $(this).closest('tr').remove();
                            tableIndex--;
                        });
                    </script>

                </div>


                  
                <div class="col-md-12 col-sm-12 col-xs-12 form-group pull-right">
                    <button type="submit" class="btn btn-primary">ذخیره</button>
                </div>
            </div>

        </div>
    </div>
    <div class="clearfix"></div>
    </div>
    </form>
    </div>
    </section>
    </div>
    </div>


    {% endblock pageContent %}